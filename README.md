# VizTracer
## Список авторов
Имя | Группа | Разделы
| --- | --- | ---
Гуницкий Р. Я. | БПИ195 |
Жупанов В. | БПИ195 |
Кулешова П. О. | БПИ195 |
Мелехин Д. А. | БПИ192 |
Цуркан Д. В. | БПИ195 |
## Регистрация изменений
Версия документа	| Дата	| Описание изменения	| Автор изменения
| --- | --- | --- | ---
01|
02|
03|
## Введение
### Название проекта
VizTracer
### Задействованные архитектурные представления
### Контекст задачи и среда функционирования системы
### Рамки и цели проекта
VizTracer - это инструмент для ведения журналов, отладки и профилирования с низкими затратами, который может отслеживать и визуализировать код на Python, что помогает лучше понять код и определить трудоемкую кода (части кода).\
VizTracer может отображать каждую выполненную функцию и соответствующее время входа/выхода от начала программы до конца, что помогает выявлять спорадические(случайные) проблемы с производительностью. 
## Архитектурные факторы (цели и ограничения)
### Ключевые и заинтересованные лица
Действующее лицо	| Заинтересованность в системе
| --- | ---
| Разработчик | Разработка поддерживаемой системы соответствующей требованиям; Написание документации;
Заказчик  | Предоставление требований; Установка дедлайнов разработки; Прием конечного продукта
Архитектор ПО | Разработка архитектуры системы
Тестировщик | Тестирование продукта на каждом этапе разработки; Проверка выполнения всех требований;


### Ключевые требования к системе
- Система должна работать на Linux/MacOS/Windows
- Система должна иметь возможность установки через pip3
- Система должна поддерживать Jupyter Notebook
- Система должна уметь профилировать python файл из консоли и записывать результат в файл формата json
- Система должна уметь отображать результат профилирования (из json файла)
- Система должна предоставлять пользователю возможность установки собственного значения размера буффера (Дефолтное значение 150МБ)
- Система должна уметь считывать настройки из конфиг файла
- Система должна иметь возможно дебага файла профилирования из консоли (с помощью команды vdb)
### Ключевые ограничения
- Требуется версия python 3.6 или выше
- При использование WSL1 (Windows Subsystem Linux) невозможна корректная работа системы. Требуется обновление до WSL2
- Система должна быть написана на Python & C/C++

 
## Общие архитектурные решения
### Принципы проектирования
 
## Архитектурные представления
В данном разделе подробно описывается каждое из используемых в проекте архитектурных представлений.
### Представление прецендентов
Рассматриваемая система предлагает пользователям детальную информацию о работе скрипта, написанного на языке Python, выступая в качестве помощника при отладке, логировании и профилировании кода. Результат работы системы отвечает на следующий вопрос: “Почему моя программа делает это?”. Основная идея VizTracer – помочь понять, что делает программа. VizTracer фокусируется на стеке вызовов по ходу выполнения кода и может визуализировать каким образом вызываются функции, одна за другой, пока отрабатывает код.

Так как система работает локально на устройстве из актеров можно выделить рядового Python разработчика/аналитика. 

Пользователь должен обладать следующими возможностями использования системы: 

- выполнение скрипта/модуля на языке Python из командной строки с помощью VizTracer (в т. ч. с исходными аргументами)
- получение отчета о ходе выполнения кода, после завершения исполнения, в трех форматах – json, html, gz (управление настройками возможностями системы и фильтрации отчета ложится на аргументы командной строки)
- визуализация процессного времени, потраченного на функции (flamegraph)
- ручной запуск/остановка профилирования в скрипте для отдельных частей кода
- генерация и отображение отчета в Jupyter Notebook
- открытие отчета из командной строки в браузере
- объединение нескольких отчетов, созданных системой 
- удаленное присоединение/отключение к продолжающемуся процессу
- виртуальная отладка программы по сохраненному отчету в формате Json


### Логическое представление

![Alt text](C:/Users/Daniel Tsurkan/msg1068871904-37341.jpg?raw=true "Title")

### Представление архитектуры процессов
Основная часть VizTracer написана на чистом C. В среднем выполнение скрипта с помощью VizTracer увеличивается меньше, чем вдвое, по сравнению с выполнение скрипта с помощью Python, а в худшем случае может доходить до тройного увеличения времени выполнения.

В рассматриваемой системе параллелизм является неотъемлемым функционалом, позволяющим выполнять предоставленный скрипт, в том же формате, в котором он был написан. То есть VizTracer способен выполнять предоставленный ему асинхронный код и выводить отчет по каждому процессу. Также VizTracer может визуализировать код, выполняемый в многопоточном формате, с помощью flamegraph. 

Набор основных выполняемых процессов системы:
- Запуск скрипта/модуля, написанного на языке Python из командной строки
- Генерация отчета с помощью open-source инструмента Perfetto
- Присоединение/отключение к запущенному процессу для трассировки кода
- Просмотр сгенерированного отчета с помощью VizTracer

### Физическое представление архитектуры
### Представление развёртывания
### Представление архитектуры данных
### Представление архитектуры безопасности
### Представление реализации и разработки
### Представление производительности
### Атрибуты качества системы
#### Объём данных и производительность системы
#### Гарантии качества работы системы
### Другие представления
 
## Техническое описание отдельных ключевых архитектурных решений
### Техническое описание решения №1
#### Проблема
#### Идея решения
#### Факторы
#### Решение
#### Мотивировка
#### Неразрешённые вопросы
#### Альтернативы
 
## Приложение
### Словарь терминов
### Ссылки на использованные документы
- [VizTracer репозиторий](https://github.com/gaogaotiantian/viztracer)
- [VizTracer документация для пользователя](https://viztracer.readthedocs.io/en/stable/)
- [VizTracer описание проекта на Medium](https://gaogaotiantian.medium.com/why-you-should-try-viztracer-to-understand-your-python-program-9e08ccbd5e97)
### Определения
### Другое
